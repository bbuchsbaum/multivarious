% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nystrom_embedding.R
\name{nystrom_approx}
\alias{nystrom_approx}
\title{Nyström approximation for kernel-based decomposition (Unified Version)}
\usage{
nystrom_approx(
  X,
  kernel_func = NULL,
  ncomp = min(dim(X)),
  landmarks = NULL,
  nlandmarks = 10,
  preproc = pass(),
  method = c("standard", "double"),
  l = NULL,
  use_RSpectra = TRUE,
  ...
)
}
\arguments{
\item{X}{A numeric matrix or data frame of size (N x D), where N is number of samples.}

\item{kernel_func}{A kernel function with signature \code{kernel_func(X, Y, ...)}.
If NULL, defaults to a linear kernel: X \%*\% t(Y).}

\item{ncomp}{Number of components (eigenvectors/eigenvalues) to return.}

\item{landmarks}{A vector of row indices (of X) specifying the landmark points.
If NULL, \code{nlandmarks} points are sampled uniformly at random.}

\item{nlandmarks}{The number of landmark points to sample if \code{landmarks} is NULL. Default is 10.}

\item{preproc}{A pre-processing pipeline (default \code{prep(pass())}) to apply before computing the kernel.}

\item{method}{Either "standard" (the classic single-stage Nyström) or "double" (the two-stage Double Nyström method).}

\item{l}{Intermediate rank for the double Nyström method. Ignored if \code{method="standard"}.
Typically, \code{l < length(landmarks)} to reduce complexity.}

\item{use_RSpectra}{Logical. If TRUE, use \code{RSpectra::svds} for partial SVD. Recommended for large problems.}

\item{...}{Additional arguments passed to \code{kernel_func}.}
}
\value{
A \code{bi_projector} object with fields:
\describe{
\item{\code{v}}{The eigenvectors (N x ncomp) approximating the kernel eigenbasis.}
\item{\code{s}}{The scores (N x ncomp) = v * diag(sdev), analogous to principal component scores.}
\item{\code{sdev}}{The square roots of the eigenvalues.}
\item{\code{preproc}}{The pre-processing pipeline used.}
}
}
\description{
Approximate the eigen-decomposition of a large kernel matrix using either
the standard Nyström method or the Double Nyström method.
}
\details{
The Double Nyström method introduces an intermediate step that reduces the
size of the decomposition problem, potentially improving efficiency and scalability.
}
\examples{
set.seed(123)
X <- matrix(rnorm(1000*1000), 1000, 1000)
# Standard Nyström
res_std <- nystrom_approx(X, ncomp=5, nlandmarks=20, method="standard")
# Double Nyström
res_db <- nystrom_approx(X, ncomp=5, nlandmarks=20, method="double", l=10)
}
