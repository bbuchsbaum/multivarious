% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pca.R
\name{perm_ci.pca}
\alias{perm_ci.pca}
\title{Permutation-Based Confidence Intervals for PCA Components}
\usage{
\method{perm_ci}{pca}(x, X, nperm = 100, k = 4, distr = "gamma", parallel = FALSE, ...)
}
\arguments{
\item{x}{A PCA object from \code{pca()}.}

\item{X}{The original data matrix used for PCA.}

\item{nperm}{Number of permutations.}

\item{k}{Number of components (beyond the first) to test. Default tests up to \code{min(Q-1, k)}.}

\item{distr}{Distribution to fit to the permutation results ("gamma", "norm", or "empirical").}

\item{parallel}{Logical, whether to use parallel processing for permutations.}

\item{...}{Additional arguments passed to \code{fitdistrplus::fitdist} or parallelization.}
}
\value{
A list containing:
\describe{
\item{observed}{The observed F_a values for tested components.}
\item{perm_values}{A matrix of permuted F-values. Each column corresponds to a component.}
\item{fit}{A list of fit objects or NULL if empirical chosen.}
\item{ci}{Computed confidence intervals for each component.}
\item{p}{p-values for each component.}
}
}
\description{
Perform a permutation test to assess the significance of variance explained by PCA components.
}
\details{
The function computes a statistic \code{F_a} for each component \code{a}, representing the fraction
of variance explained relative to the remaining components. It then uses permutations of
the preprocessed data to generate a null distribution. The first component uses the full data;
subsequent components are tested by partialing out previously identified components and
permuting the residuals.

By default, a gamma distribution is fit to the permuted values to derive CIs and p-values.
If \code{distr="empirical"}, it uses empirical quantiles instead.
}
