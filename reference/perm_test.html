<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generic Permutation-Based Test — perm_test • multivarious</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generic Permutation-Based Test — perm_test"><meta name="description" content="This generic function implements a permutation-based test to assess the significance
of components or statistics in a fitted model. The actual procedure depends on
the method defined for the specific model class. Typical usage:"><meta property="og:description" content="This generic function implements a permutation-based test to assess the significance
of components or statistics in a fitted model. The actual procedure depends on
the method defined for the specific model class. Typical usage:"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multivarious</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Classifier.html">Classifying in latent space: k-NN &amp; Random-Forest wrappers</a></li>
    <li><a class="dropdown-item" href="../articles/Composing_Projectors.html">Composing Projectors: Chaining Models</a></li>
    <li><a class="dropdown-item" href="../articles/CPCAplus.html">Contrastive PCA: Finding What's Different Between Groups</a></li>
    <li><a class="dropdown-item" href="../articles/CrossValidation.html">Cross-validation for Dimensionality Reduction</a></li>
    <li><a class="dropdown-item" href="../articles/Extending.html">Extending multiblock: CCA and glmnet Examples</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction to the multivarious Package</a></li>
    <li><a class="dropdown-item" href="../articles/Multiblock.html">Multiblock basics: one projector, many tables</a></li>
    <li><a class="dropdown-item" href="../articles/Nystrom.html">Kernel PCA Made Fast: The Nyström Approximation</a></li>
    <li><a class="dropdown-item" href="../articles/Partial_Projection.html">Partial projection: working with incomplete feature sets</a></li>
    <li><a class="dropdown-item" href="../articles/PermutationTesting.html">Permutation Testing in multivarious</a></li>
    <li><a class="dropdown-item" href="../articles/PreProcessing.html">Pre-processing pipelines in multiblock</a></li>
    <li><a class="dropdown-item" href="../articles/Regress.html">Linear Re-representation with regress()</a></li>
    <li><a class="dropdown-item" href="../articles/SVD_PCA.html">SVD wrapper, PCA and the bi_projector</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generic Permutation-Based Test</h1>

      <div class="d-none name"><code>perm_test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This generic function implements a permutation-based test to assess the significance
of components or statistics in a fitted model. The actual procedure depends on
the method defined for the specific model class. Typical usage:</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A fitted model object (e.g. <code>pca</code>, <code>cross_projector</code>, <code>discriminant_projector</code>, <code>multiblock_biprojector</code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed down to <code>shuffle_fun</code> or <code>measure_fun</code> (if applicable).
Note: For <code>multiblock</code> methods, <code>Xlist</code>, <code>comps</code>, <code>alpha</code>, and <code>use_rspectra</code> (for biprojector) are handled as direct named arguments, not via <code>...</code>.</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>(Used by <code>pca</code>, <code>cross_projector</code>, <code>discriminant_projector</code>) The original primary data matrix used to fit <code>x</code>. Ignored by the <code>multiblock_biprojector</code> method.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>(Used by <code>cross_projector</code>) The secondary data block (n x pY). Ignored by other methods.</p></dd>


<dt id="arg-xlist">Xlist<a class="anchor" aria-label="anchor" href="#arg-xlist"></a></dt>
<dd><p>(Used by <code>multiblock_biprojector</code> [optional, default <code>NULL</code>] and <code>multiblock_projector</code> [required]) List of data blocks.</p></dd>


<dt id="arg-nperm">nperm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>Integer number of permutations (Default: 1000 for PCA, 500 for multiblock methods, 100 otherwise).</p></dd>


<dt id="arg-measure-fun">measure_fun<a class="anchor" aria-label="anchor" href="#arg-measure-fun"></a></dt>
<dd><p>(Optional; Used by <code>pca</code>, <code>cross_projector</code>, <code>discriminant_projector</code>, <code>multiblock_projector</code>) A function for computing the statistic(s) of interest. Ignored by <code>multiblock_biprojector</code>. Signature/default varies by method (see Details).</p></dd>


<dt id="arg-shuffle-fun">shuffle_fun<a class="anchor" aria-label="anchor" href="#arg-shuffle-fun"></a></dt>
<dd><p>(Optional; Used by all methods) A function for permuting the data appropriately. Signature/default varies by method (see Details).</p></dd>


<dt id="arg-fit-fun">fit_fun<a class="anchor" aria-label="anchor" href="#arg-fit-fun"></a></dt>
<dd><p>(Optional; Used by <code>cross_projector</code>, <code>discriminant_projector</code>) A function for re-fitting a new model. Ignored by PCA and multiblock methods. Signature/default varies by method (see Details).</p></dd>


<dt id="arg-stepwise">stepwise<a class="anchor" aria-label="anchor" href="#arg-stepwise"></a></dt>
<dd><p>(Used by <code>pca</code>) Logical indicating if sequential testing (P3 projection) should be performed. Default <code>TRUE</code>. (The multiblock methods also perform sequential testing based on <code>alpha</code> and <code>comps</code>, but this argument is ignored). Ignored by other methods.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>(Used by all methods) Logical; if <code>TRUE</code>, attempt parallel execution via <code><a href="https://future.apply.futureverse.org/reference/future_lapply.html" class="external-link">future.apply::future_lapply</a></code>.</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>(Used by all methods) Character string for the alternative hypothesis: "greater" (default), "less", or "two.sided".</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>(Used by <code>pca</code>, <code>multiblock_biprojector</code>, <code>multiblock_projector</code>) Significance level for sequential stopping rule (default 0.05). Passed directly as a named argument to these methods.</p></dd>


<dt id="arg-comps">comps<a class="anchor" aria-label="anchor" href="#arg-comps"></a></dt>
<dd><p>(Used by <code>pca</code>, <code>multiblock_biprojector</code>, <code>multiblock_projector</code>) Maximum number of components to test sequentially (default 4). Passed directly as a named argument to these methods.</p></dd>


<dt id="arg-use-svd-solver">use_svd_solver<a class="anchor" aria-label="anchor" href="#arg-use-svd-solver"></a></dt>
<dd><p>(Used by <code>pca</code>) Optional string specifying the SVD solver (default "fast").</p></dd>


<dt id="arg-use-rspectra">use_rspectra<a class="anchor" aria-label="anchor" href="#arg-use-rspectra"></a></dt>
<dd><p>(Used by <code>multiblock_biprojector</code>) Logical indicating whether to use RSpectra for eigenvalue calculation (default <code>TRUE</code>). Passed directly as a named argument.</p></dd>


<dt id="arg-predict-method">predict_method<a class="anchor" aria-label="anchor" href="#arg-predict-method"></a></dt>
<dd><p>(Used by <code>discriminant_projector</code>) Prediction method (<code>"lda"</code> or <code>"euclid"</code>) used by the default measure function (default "lda").</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The structure of the return value depends on the method:</p><dl><dt><strong><code>cross_projector</code></strong> and <strong><code>discriminant_projector</code></strong>:</dt>
<dd><p>Returns an object of class <code>perm_test</code>, a list containing: <code>statistic</code>, <code>perm_values</code>, <code>p.value</code>, <code>alternative</code>, <code>method</code>, <code>nperm</code>, <code>call</code>.</p></dd>

<dt><strong><code>pca</code></strong>, <strong><code>multiblock_biprojector</code></strong>, and <strong><code>multiblock_projector</code></strong>:</dt>
<dd><p>Returns an object inheriting from <code>perm_test</code> (classes <code>perm_test_pca</code>, <code>perm_test_multiblock</code>, or <code>perm_test</code> respectively for multiblock_projector),
a list containing: <code>component_results</code> (data frame with observed stat, pval, CIs per component), <code>perm_values</code> (matrix of permuted stats), <code>alpha</code> (if applicable), <code>alternative</code>, <code>method</code>, <code>nperm</code> (vector of successful permutations per component), <code>call</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ol><li><p>Shuffle or permute the data in a way that breaks the structure of interest
(e.g., shuffle labels for supervised methods, shuffle columns/rows for unsupervised).</p></li>
<li><p>Re-fit or re-project the model on the permuted data. Depending on the class,
this can be done via a <code>fit_fun</code> or a class-specific approach.</p></li>
<li><p>Measure the statistic of interest (e.g., variance explained, classification accuracy, canonical correlation).</p></li>
<li><p>Compare the distribution of permuted statistics to the observed statistic to compute an empirical p-value.</p></li>
</ol><p>S3 methods define the specific defaults and required signatures for the functions
involved in shuffling, fitting, and measuring.</p>
<p>This function provides a framework for permutation testing in various multivariate models.
The specific implementation details, default functions, and relevant arguments vary by method.</p>
<p><strong>PCA Method (<code>perm_test.pca</code>):</strong>
Relevant arguments: <code>X</code>, <code>nperm</code>, <code>measure_fun</code>, <code>shuffle_fun</code>, <code>stepwise</code>, <code>parallel</code>, <code>alternative</code>, <code>alpha</code>, <code>comps</code>, <code>use_svd_solver</code>, <code>...</code>. Assesses significance of variance explained by each PC (Vitale et al., 2017). Default statistic: F_a. Default shuffle: column-wise. Default uses P3 projection and sequential stopping with <code>alpha</code>.</p>
<p><strong>Cross Projector Method (<code>perm_test.cross_projector</code>):</strong>
Relevant arguments: <code>X</code>, <code>Y</code>, <code>nperm</code>, <code>measure_fun</code>, <code>shuffle_fun</code>, <code>fit_fun</code>, <code>parallel</code>, <code>alternative</code>, <code>...</code>. Tests the X-Y relationship. Default statistic: <code>x2y.mse</code>. Default shuffle: rows of Y. Default fit: <code><a href="https://rdrr.io/r/stats/cancor.html" class="external-link">stats::cancor</a></code>.</p>
<p><strong>Discriminant Projector Method (<code>perm_test.discriminant_projector</code>):</strong>
Relevant arguments: <code>X</code>, <code>nperm</code>, <code>measure_fun</code>, <code>shuffle_fun</code>, <code>fit_fun</code>, <code>predict_method</code>, <code>parallel</code>, <code>alternative</code>, <code>...</code>. Tests class separation. Default statistic: prediction accuracy. Default shuffle: labels. Default fit: <code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">MASS::lda</a></code>.</p>
<p><strong>Multiblock Bi-Projector Method (<code>perm_test.multiblock_biprojector</code>):</strong>
Relevant arguments: <code>Xlist</code> (optional), <code>nperm</code>, <code>shuffle_fun</code>, <code>parallel</code>, <code>alternative</code>, <code>alpha</code>, <code>comps</code>, <code>use_rspectra</code>, <code>...</code>. Tests consensus using fixed internal statistic (eigenvalue) on scores for each component. The statistic is the leading eigenvalue of the covariance matrix of block scores for a given component (T^T, where T columns are scores of block <em>b</em> on component <em>k</em>). By default, it shuffles rows within each block independently (either from <code>Xlist</code> if provided via <code>...</code>, or using the internally stored scores). It performs sequential testing for components specified by <code>comps</code> using the stopping rule defined by <code>alpha</code> (both passed via <code>...</code>).</p>
<p><strong>Multiblock Projector Method (<code>perm_test.multiblock_projector</code>):</strong>
Relevant arguments: <code>Xlist</code> (required), <code>nperm</code>, <code>measure_fun</code>, <code>shuffle_fun</code>, <code>parallel</code>, <code>alternative</code>, <code>alpha</code>, <code>comps</code>, <code>...</code>. Tests consensus using <code>measure_fun</code> (default: mean abs corr) on scores projected from <code>Xlist</code> using the original model <code>x</code>. Does not refit.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Buja, A., &amp; Eyuboglu, N. (1992). Remarks on parallel analysis. <em>Multivariate Behavioral Research</em>, 27(4), 509-540. (Relevant for PCA permutation concepts)</p>
<p>Vitale, R., Westerhuis, J. A., Næs, T., Smilde, A. K., de Noord, O. E., &amp; Ferrer, A. (2017).
Selecting the number of factors in principal component analysis by permutation testing—
Numerical and practical aspects. <em>Journal of Chemometrics</em>, 31(10), e2937.
<a href="https://doi.org/10.1002/cem.2937" class="external-link">doi:10.1002/cem.2937</a>
 (Specific to <code>perm_test.pca</code>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="pca.html">pca</a></code>, <code><a href="cross_projector.html">cross_projector</a></code>, <code><a href="discriminant_projector.html">discriminant_projector</a></code>,
<code><a href="multiblock_biprojector.html">multiblock_biprojector</a></code>,
<code><a href="measure_interblock_transfer_error.html">measure_interblock_transfer_error</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># PCA Example</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="pca.html">pca</a></span><span class="op">(</span><span class="va">X_iris</span>, ncomp<span class="op">=</span><span class="fl">4</span>, preproc<span class="op">=</span><span class="fu"><a href="center.html">center</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Ensure centering</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test first 3 components sequentially (faster with more nperm)</span></span></span>
<span class="r-in"><span><span class="co"># Ensure a future plan is set for parallel=TRUE, e.g., future::plan("multisession")</span></span></span>
<span class="r-in"><span><span class="va">res_pca</span> <span class="op">&lt;-</span> <span class="fu">perm_test</span><span class="op">(</span><span class="va">mod_pca</span>, <span class="va">X_iris</span>, nperm<span class="op">=</span><span class="fl">50</span>, comps<span class="op">=</span><span class="fl">3</span>, parallel<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Pre-calculating reconstructions for stepwise testing...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running 50 permutations sequentially for up to 3 PCA components (alpha=0.050, serial)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Testing Component 1/3...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Testing Component 2/3...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Testing Component 3/3...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Component 3 p-value (0.05882) &gt; alpha (0.050). Stopping sequential testing.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_pca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCA Permutation Test Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  Permutation test for PCA (Vitale et al. 2017 P3) (statistic: F_a (Fraction of Remaining Variance), stepwise: TRUE, shuffle: column-wise) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternative:  greater </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Component Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   comp  observed       pval  lower_ci  upper_ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1 0.9246187 0.01960784 0.6817051 0.6895225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2 0.7039743 0.01960784 0.6045818 0.6920858</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    3 0.7664247 0.05882353 0.6674626 0.7726917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of successful permutations per component: 50, 50, 50 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PCA Example with row shuffling (tests different null hypothesis)</span></span></span>
<span class="r-in"><span><span class="va">row_shuffle</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span>, <span class="va">...</span><span class="op">)</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">res_pca_row</span> <span class="op">&lt;-</span> <span class="fu">perm_test</span><span class="op">(</span><span class="va">mod_pca</span>, <span class="va">X_iris</span>, nperm<span class="op">=</span><span class="fl">50</span>, comps<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>                         shuffle_fun<span class="op">=</span><span class="va">row_shuffle</span>, parallel<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Pre-calculating reconstructions for stepwise testing...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running 50 permutations sequentially for up to 3 PCA components (alpha=0.050, serial)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Testing Component 1/3...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Component 1 p-value (0.4314) &gt; alpha (0.050). Stopping sequential testing.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_pca_row</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCA Permutation Test Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  Permutation test for PCA (Vitale et al. 2017 P3) (statistic: F_a (Fraction of Remaining Variance), stepwise: TRUE, shuffle: custom) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternative:  greater </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Component Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   comp  observed      pval  lower_ci  upper_ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1 0.9246187 0.4313725 0.9246187 0.9246187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of successful permutations per component: 50 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Cross Projector Example (using cancor)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ccr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cancor.html" class="external-link">cancor</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod_cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="cross_projector.html">cross_projector</a></span><span class="op">(</span><span class="va">ccr</span><span class="op">$</span><span class="va">xcoef</span>, <span class="va">ccr</span><span class="op">$</span><span class="va">ycoef</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perm test (is x2y.mse lower than chance?)</span></span></span>
<span class="r-in"><span><span class="va">res_cp</span> <span class="op">&lt;-</span> <span class="fu">perm_test</span><span class="op">(</span><span class="va">mod_cp</span>, <span class="va">X</span>, Y<span class="op">=</span><span class="va">Y</span>, nperm<span class="op">=</span><span class="fl">50</span>, alternative<span class="op">=</span><span class="st">"less"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_cp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Discriminant Projector Example (using LDA)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lda_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">lda</a></span><span class="op">(</span><span class="va">X_iris</span>, grouping<span class="op">=</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod_dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="discriminant_projector.html">discriminant_projector</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  v <span class="op">=</span> <span class="va">lda_fit</span><span class="op">$</span><span class="va">scaling</span>,</span></span>
<span class="r-in"><span>  s <span class="op">=</span> <span class="va">X_iris</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">lda_fit</span><span class="op">$</span><span class="va">scaling</span>,</span></span>
<span class="r-in"><span>  sdev <span class="op">=</span> <span class="va">lda_fit</span><span class="op">$</span><span class="va">svd</span>,</span></span>
<span class="r-in"><span>  labels <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>,</span></span>
<span class="r-in"><span>  preproc <span class="op">=</span> <span class="fu"><a href="prep.html">prep</a></span><span class="op">(</span><span class="fu"><a href="center.html">center</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Assuming center() was intended for LDA</span></span></span>
<span class="r-in"><span>  Sigma <span class="op">=</span> <span class="va">lda_fit</span><span class="op">$</span><span class="va">covariance</span> <span class="co"># Needed for LDA prediction method</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perm test (is accuracy higher than chance?)</span></span></span>
<span class="r-in"><span><span class="va">res_dp</span> <span class="op">&lt;-</span> <span class="fu">perm_test</span><span class="op">(</span><span class="va">mod_dp</span>, <span class="va">X_iris</span>, nperm<span class="op">=</span><span class="fl">50</span>, alternative<span class="op">=</span><span class="st">"greater"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_dp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiblock Bi-Projector Example</span></span></span>
<span class="r-in"><span><span class="co"># (Requires a multiblock model 'mod_mb' from e.g. MFA or ComDim)</span></span></span>
<span class="r-in"><span><span class="co"># Assuming 'mod_mb' exists and has 2 blocks:</span></span></span>
<span class="r-in"><span><span class="co"># res_mb &lt;- perm_test(mod_mb, nperm=50, comps=3) </span></span></span>
<span class="r-in"><span><span class="co"># print(res_mb)</span></span></span>
<span class="r-in"><span><span class="co"># Example using provided Xlist (list of matrices X1, X2):</span></span></span>
<span class="r-in"><span><span class="co"># X1 &lt;- matrix(rnorm(50*10), 50, 10)</span></span></span>
<span class="r-in"><span><span class="co"># X2 &lt;- matrix(rnorm(50*15), 50, 15)</span></span></span>
<span class="r-in"><span><span class="co"># Assume mod_mb was fit on cbind(X1, X2) with block_indices=list(1:10, 11:25)</span></span></span>
<span class="r-in"><span><span class="co"># res_mb_xlist &lt;- perm_test(mod_mb, Xlist=list(X1, X2), nperm=50, comps=3)</span></span></span>
<span class="r-in"><span><span class="co"># print(res_mb_xlist)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

